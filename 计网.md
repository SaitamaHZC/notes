# 计算机网络

## 基础

### 因特网的描述方式

1. 根据硬件和软件组成描述：

   **端系统/主机** 通过 **通信链路**和**分组交换机** 连接在一起。

   **分组**：将数据分段，并为每段加上首部字节。

   端系统通过**ISP**(Internet Service Provider)接入因特网

   端系统、分组交换机和其他部件需要遵循一系列**协议**

2. 根据基础设施向分布式应用程序提供的服务来描述



### 接入网

接入网指，将端系统物理连接至**边缘路由器**（端系统到任何其他远程端系统路径上的第一台路由器）的网络



家庭接入方式有：

1. 数字用户线DSL 利用本地的电话基础设施  ----使用双绞铜线
2. 电缆 利用有线电视基础设施                       ----使用同轴电缆
3. 光纤：分为**主动光纤网络AON** 和 **被动光纤网络PON**



### 网络基础结构

![image-20220907105700047](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907105700047.png)



### 分组交换

端系统将数据**分组**后通过通信链路和**分组交换机**传输数据



#### 存储转发传输

在交换机接收到完整分组，才向通信链路输出。



L比特的分组，R比特/秒的传输速率

每台router增加L/R的延时，源直接到目的地用时L/R

故： **由N条速率为R的链路（有N-1台router），时延为:**
$$
	d = N*L/R
$$


**排队时延和分组丢失：**

每台分组交换机有**输出缓存/输出队列**，除了存储转发时延外，分组还需要承受输出缓存的**排队时延**，当输出缓存被占满，就会产生**丢包(package loss)**



**转发表和路由选择协议：**

分组的首部包含目的地的IP地址。

且每台路由器具有一个转发表，用于将目的地址（或一部分）映射成输出链路。

类似邮政快递 上海-嘉定-嘉定工业区-xx路







#### 电路交换

先建立一条专用的端到端连接，预留好资源



**分组交换不适合实时服务**，因为其变化不可预测的时延，但提供了更好的带宽共享，比电路交换更简单、有效，实现成本更低





#### 时延

分为：**节点处理时延、排队时延、传输时延、传播时延**



处理时延：

主机或路由器在收到分组时，为处理分组（例如分析首部、提取数据、差错检验或查找路由）所花费的时间。



排队时延：

分组在路由器输入、输出队列中排队等待处理所经 历的时延。 

排队时延的长短往往取决于网络中当时的通信量。 队列溢出时，相当于排队时延无限大



传输时延：

也叫发送时延

发送数据时，将整个分组的比特推向链路的时间。 

![image-20220907110712462](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907110712462.png)



传播时延：

电磁波在信道中需要传播一定的距离而花费的时间。

 发送时延与传播时延有本质上的不同。信号发送速率和信号在信道上的传播速率是完全不同的概念。

​	![image-20220907110706291](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907110706291.png)







![image-20220907111346940](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907111346940.png)



#### 吞吐量

瞬时吞吐量：任何时间瞬间，接受端主机接受数据的速率

平均吞吐量：接收F比特用时T秒，平均吞吐量则为F/T



假设以下传输情况：

服务器-----路由器-----客户

服务器到路由器的链路速率为Rs，路由器到客户的链路速率为Rc

吞吐量为:min{Rs,Rc}



因特网核心具有非常高的传输速率，因此**限制吞吐量的因素通常是接入网**







### 协议

网络设计者以**分层**的方式组织协议以及实现协议的网络硬件和软件

分层好处：

1. 各层之间是独立的。
2. 灵活性好。 
3. 结构上可分割开。 
4. 易于实现和维护。 
5. 能促进标准化工作。 

缺点 ： 有些功能会在不同的层次中重复出现，因而产生了额外开销。





各层的所有协议被称为**协议栈**

因特网的协议栈由五个层次组成：

物理层、链路层、网络层、运输层、应用层

![image-20220907120159264](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907120159264.png)



![image-20220907121357461](C:\Users\Saitama\AppData\Roaming\Typora\typora-user-images\image-20220907121357461.png)



------



## 应用层

位于应用层的分组数据叫做**报文**

### 应用程序体系结构

C/S 客户-服务器体系结构：1.服务器处理请求 2. 服务器具有固定、周知的IP地址

P2P 	1. 不要求专用服务器 2.具有自扩展性（每个人通过分发文件增加系统服务能力）



### 进程通信

谈论在**两个端系统**上的进程通信，而非同一个端系统上不同进程的通信



发起通信的进程为**客户**，在会话开始时等待联系的进程为**服务器**

进程通过**套接字(socket)**向网络发送和接收报文

套接字是应用程序进程**和运输层协议之间的接口** 。运输层为此能提供以下服务：可靠数据传输、吞吐量、定时、安全性



#### **进程寻址**

发送进程，需要两种信息：1. 目的地主机地址 2. 目的主机中指定接受的进程的标识符

对应：

1. 发送目的地的**IP地址**   2.**端口号**



### 因特网提供的运输服务

提供的服务有：TCP/ UDP

TCP先让客户和服务器交换运输层控制信息，**握手后建立TCP连接**。**提供可靠的数据传送服务**（无差错）

UDP**只提供最小服务**，没有握手过程，**不保证可靠**，但可以选定**任何速率**注入数据（快）





### 应用层协议

#### HTTP 超文本传输协议

HTTP定义了web客户向web服务器请求web页面的方式，以及服务器向客户传送web页面的方式。

HTTP**采用TCP作为运输协议**。HTTP不保存客户的任何信息，是**无状态协议**



非持续连接：每一个请求/响应经单独的TCP连接发送

持续连接：所有请求和响应经同一TCP连接发送



**三次握手：**

1. 客户向服务器发送一个小TCP报文段
2. 服务器用一个小TCP报文段作出确认和回应
3. 客户向服务器返回确认



**HTTP请求报文：**

![image-20220919093348654](http://hzc-typora.oss-cn-shanghai.aliyuncs.com/img/image-20220919093348654.png)

第一行叫做**请求行**，后继的行叫做**首部行**

**请求行由：方法字段、URL字段、HTTP版本字段构成**

![image-20220919093316601](http://hzc-typora.oss-cn-shanghai.aliyuncs.com/img/image-20220919093316601.png)

方法字段有：GET/POST/HEAD(响应但不返回请求对象)/PUT(客户上传对象)/DELETE（客户删除服务器中的对象）



**HTTP响应报文：**

![image-20220919093404321](http://hzc-typora.oss-cn-shanghai.aliyuncs.com/img/image-20220919093404321.png)

由：**初始状态行 首部行 实体体** 组成

状态码:

●200 OK:请求成功，信息在返回的响应报文中。
●301 Moved Permanently: 请求的对象已经被永久转移了，新的URL定义在响应报文的Location:首部行中。客户软件将自动获取新的URL。
●400BadRequest:一个通用差错代码，指示该请求不能被服务器理解。
●404 Not Found: 被请求的文档不在服务器上。
●505HTTPVersionNotSupported:服务器不支持请求报文使用的HTTP协议版本。



##### cookie

e